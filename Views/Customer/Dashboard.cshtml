@model IEnumerable<African_Beauty_Trading.Models.Order>
@{
    ViewBag.Title = "Dashboard";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<div class="d-flex justify-content-between align-items-center mb-3">
    <h2>My Orders</h2>
    <a href="#" onclick="return confirmLogout();" class="btn btn-outline-primary">
        <i class="fas fa-home me-1"></i> Home & Logout
    </a>
</div>

<

<!-- Tab Content -->
<div class="tab-content" id="orderTabContent">
    <!-- All Orders Tab -->
    <div class="tab-pane fade show active" id="all-orders" role="tabpanel">
        <div class="table-responsive mt-3">
            <table class="table table-bordered table-hover">
                <thead class="table-light">
                    <tr>
                        <th>Order #</th>
                        <th>Priority</th>
                        <th>Date</th>
                        <th>Status</th>
                        <th>Total</th>
                        <th>Track</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var order in Model)
                    {
                        <tr>
                            <td>@order.Id</td>
                            <td>
                                @if (order.Priority == "Urgent")
                                {
                                    <span class="badge bg-danger">
                                        <i class="fas fa-flag"></i> Urgent
                                    </span>
                                }
                                else if (order.Priority == "Normal")
                                {
                                    <span class="badge bg-success">
                                        <i class="fas fa-flag"></i> Normal
                                    </span>
                                }
                                else
                                {
                                    <span class="badge bg-secondary">
                                        <i class="fas fa-flag"></i> Not Set
                                    </span>
                                }
                            </td>
                            <td>@(order.OrderDate.HasValue ? order.OrderDate.Value.ToString("yyyy-MM-dd") : "")</td>
                            <td>
                                <span class="badge @GetStatusBadge(order.DeliveryStatus)">
                                    @order.DeliveryStatus
                                </span>
                            </td>
                            <td>R @order.TotalPrice.ToString("N2")</td>
                           
                            <td>
                                @Html.ActionLink("Track", "Track", "Customer", new { id = order.Id }, new { @class = "btn btn-primary btn-sm" })
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>

    <!-- Purchase Orders Tab -->
    <div class="tab-pane fade" id="purchase-orders" role="tabpanel">
        <div class="table-responsive mt-3">
            <table class="table table-bordered table-hover">
                <thead class="table-light">
                    <tr>
                        <th>Order #</th>
                        <th>Priority</th>
                        <th>Date</th>
                        <th>Items</th>
                        <th>Status</th>
                        <th>Total</th>
                        <th>Track</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var order in Model)
                    {
                        <tr>
                            <td>@order.Id</td>
                            <td>
                                @if (order.Priority == "Urgent")
                                {
                                    <span class="badge bg-danger">
                                        <i class="fas fa-flag"></i> Urgent
                                    </span>
                                }
                                else if (order.Priority == "Normal")
                                {
                                    <span class="badge bg-success">
                                        <i class="fas fa-flag"></i> Normal
                                    </span>
                                }
                                else
                                {
                                    <span class="badge bg-secondary">
                                        <i class="fas fa-flag"></i> Not Set
                                    </span>
                                }
                            </td>
                            <td>@(order.OrderDate.HasValue ? order.OrderDate.Value.ToString("yyyy-MM-dd") : "")</td>
                            <td>
                                @foreach (var item in order.OrderItems)
                                {
                                    <div class="purchase-item">
                                        <strong>@item.Product.Name</strong> (Qty: @item.Quantity)
                                        <br /><small class="text-muted">R @item.Price.ToString("N2")</small>
                                    </div>
                                }
                            </td>
                            <td>
                                <span class="badge @GetStatusBadge(order.DeliveryStatus)">
                                    @order.DeliveryStatus
                                </span>
                            </td>
                            <td>R @order.OrderItems.Sum(oi => oi.Price).ToString("N2")</td>
                            <td>
                                @Html.ActionLink("Track", "Track", "Customer", new { id = order.Id }, new { @class = "btn btn-primary btn-sm" })
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>

   
</div>

@functions {
    public string GetStatusBadge(string status)
    {
        switch ((status != null ? status.ToLower() : null))
        {
            case "delivered":
                return "bg-success";
            case "in transit":
            case "shipped":
                return "bg-primary";
            case "processing":
            case "assigned":
                return "bg-info";
            case "pending":
                return "bg-warning";
            case "cancelled":
                return "bg-danger";
            default:
                return "bg-secondary";
        }
    }
}

<style>
    .badge {
        font-size: 0.85em;
        padding: 0.4em 0.6em;
    }

    .driver-details {
        font-size: 0.9em;
    }

    .btn-sm {
        padding: 0.25rem 0.5rem;
        font-size: 0.8rem;
    }

    .table-hover tbody tr:hover {
        background-color: rgba(0, 123, 255, 0.05);
    }

    .nav-tabs .nav-link {
        color: #6c757d;
        border: 1px solid transparent;
        border-top-left-radius: 0.375rem;
        border-top-right-radius: 0.375rem;
    }

    .nav-tabs .nav-link:hover {
        border-color: #e9ecef #e9ecef #dee2e6;
        isolation: isolate;
    }

    .nav-tabs .nav-link.active {
        color: #495057;
        background-color: #fff;
        border-color: #dee2e6 #dee2e6 #fff;
    }

    .purchase-item, .rental-item {
        margin-bottom: 8px;
        padding: 8px;
        background-color: #f8f9fa;
        border-radius: 4px;
        border-left: 4px solid #28a745;
    }

    .rental-item {
        border-left-color: #ffc107;
    }

    .rental-period {
        text-align: center;
        font-size: 0.9em;
    }

    .tab-content {
        border: 1px solid #dee2e6;
        border-top: none;
        border-radius: 0 0 0.375rem 0.375rem;
        background-color: #fff;
    }

    .bg-info { background-color: #0dcaf0 !important; }
    .bg-warning { background-color: #ffc107 !important; }
    .bg-success { background-color: #198754 !important; }
    .table-light th {
        background-color: #000 !important;
        color: #fff !important;
    }
</style>

<!-- Add Font Awesome for icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<!-- Bootstrap 5 JS for tabs -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

@using (Html.BeginForm("Logout", "Account", FormMethod.Post, new { id = "logoutForm", style = "display:none;" }))
{
    @Html.AntiForgeryToken()
}

<script>
    function confirmLogout() {
        if (confirm('Are you sure you want to go home and logout?')) {
            document.getElementById('logoutForm').submit();
            return false;
        }
        return false;
    }
</script>